'use strict';

var truncate = function truncate(str) {
  var size = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 50;
  var postf = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '...';

  if (str.length > size) {
    return str.substring(0, size - postf.length) + postf;
  }
  return str;
};

var request = new XMLHttpRequest();

request.open('GET', '/data/news/news.json', true);

request.onload = function () {
  if (request.status >= 200 && request.status < 400) {
    var data = JSON.parse(request.responseText);
    var newsList = document.getElementById('news__list');

    var articles = data.reduce(function (acc, article) {
      var maxLength = 400;
      var more = '<a href="" class="news__link news__link--hide">more ></a>';
      if (article.body.length > maxLength) {
        more = '<a href="" class="news__link">more ></a>';
      }
      return '\n        ' + acc + '\n        <article class="news__article">\n          <div class="news__header">\n            <h3 class="news__title">' + article.title + '</h3>\n            <span class="news__date">' + article.date + '</span>\n          </div>\n          <p class="news__body">' + truncate(article.body, maxLength) + '</p>\n          ' + more + '\n        </article>\n        <div class="news__bot-line"></div>\n      ';
    }, '');
    newsList.innerHTML = articles;

    var bodies = document.getElementsByClassName('news__body');

    Array.from(document.getElementsByClassName('news__link')).forEach(function (element, index, links) {
      element.addEventListener('click', function (event) {
        event.preventDefault();
        if (links[index].getAttribute('data-state') === 'full') {
          bodies[index].innerHTML = truncate(data[index].body, 400);
          links[index].innerHTML = 'more >';
          links[index].setAttribute('data-state', 'truncated');
        } else {
          bodies[index].innerHTML = data[index].body;
          links[index].innerHTML = 'hide <';
          links[index].setAttribute('data-state', 'full');
        }
      });
    });
  } else {
    console.log('server error: ', request.status);
  }
};

request.onerror = function () {
  return console.log('loading error');
};

request.send();
'use strict';

var sliderItems = document.getElementsByClassName('slider__item');
var sliderLength = sliderItems.length;
var sliderImg = document.getElementsByClassName('slider__img')[0];

var getMargin = function getMargin(element, margin) {
  return Number(window.getComputedStyle(element).getPropertyValue(margin).match(/\d+/)[0]);
};
var slideWidth = sliderImg.width + getMargin(sliderImg, 'margin-left') + getMargin(sliderImg, 'margin-right');

var insert = function insert(first, last) {
  return document.getElementById('slider__body').insertBefore(first, last);
};

var margin = 0;

var sliderAnimate = function sliderAnimate() {
  var speed = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 15;
  var delay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;

  if (margin > -slideWidth) {
    margin -= 1;
    sliderItems[0].style.marginLeft = String(margin) + 'px';
    setTimeout(function () {
      return sliderAnimate(speed, delay);
    }, speed);
  } else if (margin === -slideWidth) {
    sliderItems[0].style.marginLeft = '0px';
    insert(sliderItems[0], sliderItems[sliderLength + 1]);
    margin = 0;
    setTimeout(function () {
      return sliderAnimate(speed, delay);
    }, delay);
  }
};

sliderAnimate();